---
- name: Build Folder Structure
  hosts: core
  gather_facts: no
  vars:
    ansible_connection: local
  vars_files:
    - vpls_design.yml
  tasks:
    - name: Generate L3VPN Datamodel
      import_role:
        name: vpls_datamodel
      when: "'pe' in group_names"

    # - debug:
    #     msg: >-
    #       {%  for vpn in vpls_domains %}
    #       {%  set vpn_circuits = vpls_domains[vpn].sites | selectattr('node','equalto',inventory_hostname) | list %}
    #       {%    if vpn_circuits %}
    #       {{ vpn }}:
    #           id: {{ vpls_domains[vpn].id }}
    #           links:
    #       {%      for ckt in vpn_circuits %}
    #             - inteface: {{ ckt.interface }}
    #               vlan: {{ ckt.vlan }}
    #       {%      endfor %}
    #       {%    endif %}
    #       {% endfor %}
        
